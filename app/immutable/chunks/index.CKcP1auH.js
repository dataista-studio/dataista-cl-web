function Q(n){var r=0,e=n.children,t=e&&e.length;if(!t)r=1;else for(;--t>=0;)r+=e[t].value;n.value=r}function T(){return this.eachAfter(Q)}function U(n,r){let e=-1;for(const t of this)n.call(r,t,++e,this);return this}function V(n,r){for(var e=this,t=[e],i,u,o=-1;e=t.pop();)if(n.call(r,e,++o,this),i=e.children)for(u=i.length-1;u>=0;--u)t.push(i[u]);return this}function X(n,r){for(var e=this,t=[e],i=[],u,o,f,s=-1;e=t.pop();)if(i.push(e),u=e.children)for(o=0,f=u.length;o<f;++o)t.push(u[o]);for(;e=i.pop();)n.call(r,e,++s,this);return this}function Y(n,r){let e=-1;for(const t of this)if(n.call(r,t,++e,this))return t}function b(n){return this.eachAfter(function(r){for(var e=+n(r.data)||0,t=r.children,i=t&&t.length;--i>=0;)e+=t[i].value;r.value=e})}function B(n){return this.eachBefore(function(r){r.children&&r.children.sort(n)})}function nn(n){for(var r=this,e=en(r,n),t=[r];r!==e;)r=r.parent,t.push(r);for(var i=t.length;n!==e;)t.splice(i,0,n),n=n.parent;return t}function en(n,r){if(n===r)return n;var e=n.ancestors(),t=r.ancestors(),i=null;for(n=e.pop(),r=t.pop();n===r;)i=n,n=e.pop(),r=t.pop();return i}function rn(){for(var n=this,r=[n];n=n.parent;)r.push(n);return r}function tn(){return Array.from(this)}function un(){var n=[];return this.eachBefore(function(r){r.children||n.push(r)}),n}function on(){var n=this,r=[];return n.each(function(e){e!==n&&r.push({source:e.parent,target:e})}),r}function*sn(){var n=this,r,e=[n],t,i,u;do for(r=e.reverse(),e=[];n=r.pop();)if(yield n,t=n.children)for(i=0,u=t.length;i<u;++i)e.push(t[i]);while(e.length)}function K(n,r){n instanceof Map?(n=[void 0,n],r===void 0&&(r=an)):r===void 0&&(r=hn);for(var e=new A(n),t,i=[e],u,o,f,s;t=i.pop();)if((o=r(t.data))&&(s=(o=Array.from(o)).length))for(t.children=o,f=s-1;f>=0;--f)i.push(u=o[f]=new A(o[f])),u.parent=t,u.depth=t.depth+1;return e.eachBefore(ln)}function fn(){return K(this).eachBefore(cn)}function hn(n){return n.children}function an(n){return Array.isArray(n)?n[1]:null}function cn(n){n.data.value!==void 0&&(n.value=n.data.value),n.data=n.data.data}function ln(n){var r=0;do n.height=r;while((n=n.parent)&&n.height<++r)}function A(n){this.data=n,this.depth=this.height=0,this.parent=null}A.prototype=K.prototype={constructor:A,count:T,each:U,eachAfter:X,eachBefore:V,find:Y,sum:b,sort:B,path:nn,ancestors:rn,descendants:tn,leaves:un,links:on,copy:fn,[Symbol.iterator]:sn};function dn(n){return n==null?null:xn(n)}function xn(n){if(typeof n!="function")throw new Error;return n}function L(){return 0}function pn(n){return function(){return n}}const yn=1664525,vn=1013904223,Z=4294967296;function gn(){let n=1;return()=>(n=(yn*n+vn)%Z)/Z}function wn(n){return typeof n=="object"&&"length"in n?n:Array.from(n)}function _n(n,r){let e=n.length,t,i;for(;e;)i=r()*e--|0,t=n[e],n[e]=n[i],n[i]=t;return n}function mn(n,r){for(var e=0,t=(n=_n(Array.from(n),r)).length,i=[],u,o;e<t;)u=n[e],o&&O(o,u)?++e:(o=Mn(i=An(i,u)),e=0);return o}function An(n,r){var e,t;if(N(r,n))return[r];for(e=0;e<n.length;++e)if(_(r,n[e])&&N(d(n[e],r),n))return[n[e],r];for(e=0;e<n.length-1;++e)for(t=e+1;t<n.length;++t)if(_(d(n[e],n[t]),r)&&_(d(n[e],r),n[t])&&_(d(n[t],r),n[e])&&N(P(n[e],n[t],r),n))return[n[e],n[t],r];throw new Error}function _(n,r){var e=n.r-r.r,t=r.x-n.x,i=r.y-n.y;return e<0||e*e<t*t+i*i}function O(n,r){var e=n.r-r.r+Math.max(n.r,r.r,1)*1e-9,t=r.x-n.x,i=r.y-n.y;return e>0&&e*e>t*t+i*i}function N(n,r){for(var e=0;e<r.length;++e)if(!O(n,r[e]))return!1;return!0}function Mn(n){switch(n.length){case 1:return kn(n[0]);case 2:return d(n[0],n[1]);case 3:return P(n[0],n[1],n[2])}}function kn(n){return{x:n.x,y:n.y,r:n.r}}function d(n,r){var e=n.x,t=n.y,i=n.r,u=r.x,o=r.y,f=r.r,s=u-e,h=o-t,a=f-i,c=Math.sqrt(s*s+h*h);return{x:(e+u+s/c*a)/2,y:(t+o+h/c*a)/2,r:(c+i+f)/2}}function P(n,r,e){var t=n.x,i=n.y,u=n.r,o=r.x,f=r.y,s=r.r,h=e.x,a=e.y,c=e.r,l=t-o,M=t-h,k=i-f,q=i-a,E=s-u,S=c-u,W=t*t+i*i-u*u,z=W-o*o-f*f+s*s,D=W-h*h-a*a+c*c,x=M*k-l*q,p=(k*D-q*z)/(x*2)-t,y=(q*E-k*S)/x,v=(M*z-l*D)/(x*2)-i,g=(l*S-M*E)/x,C=y*y+g*g-1,w=2*(u+p*y+v*g),H=p*p+v*v-u*u,j=-(Math.abs(C)>1e-6?(w+Math.sqrt(w*w-4*C*H))/(2*C):H/w);return{x:t+p+y*j,y:i+v+g*j,r:j}}function $(n,r,e){var t=n.x-r.x,i,u,o=n.y-r.y,f,s,h=t*t+o*o;h?(u=r.r+e.r,u*=u,s=n.r+e.r,s*=s,u>s?(i=(h+s-u)/(2*h),f=Math.sqrt(Math.max(0,s/h-i*i)),e.x=n.x-i*t-f*o,e.y=n.y-i*o+f*t):(i=(h+u-s)/(2*h),f=Math.sqrt(Math.max(0,u/h-i*i)),e.x=r.x+i*t-f*o,e.y=r.y+i*o+f*t)):(e.x=r.x+e.r,e.y=r.y)}function F(n,r){var e=n.r+r.r-1e-6,t=r.x-n.x,i=r.y-n.y;return e>0&&e*e>t*t+i*i}function G(n){var r=n._,e=n.next._,t=r.r+e.r,i=(r.x*e.r+e.x*r.r)/t,u=(r.y*e.r+e.y*r.r)/t;return i*i+u*u}function m(n){this._=n,this.next=null,this.previous=null}function qn(n,r){if(!(u=(n=wn(n)).length))return 0;var e,t,i,u,o,f,s,h,a,c,l;if(e=n[0],e.x=0,e.y=0,!(u>1))return e.r;if(t=n[1],e.x=-t.r,t.x=e.r,t.y=0,!(u>2))return e.r+t.r;$(t,e,i=n[2]),e=new m(e),t=new m(t),i=new m(i),e.next=i.previous=t,t.next=e.previous=i,i.next=t.previous=e;n:for(s=3;s<u;++s){$(e._,t._,i=n[s]),i=new m(i),h=t.next,a=e.previous,c=t._.r,l=e._.r;do if(c<=l){if(F(h._,i._)){t=h,e.next=t,t.previous=e,--s;continue n}c+=h._.r,h=h.next}else{if(F(a._,i._)){e=a,e.next=t,t.previous=e,--s;continue n}l+=a._.r,a=a.previous}while(h!==a.next);for(i.previous=e,i.next=t,e.next=t.previous=t=i,o=G(e);(i=i.next)!==t;)(f=G(i))<o&&(e=i,o=f);t=e.next}for(e=[t._],i=t;(i=i.next)!==t;)e.push(i._);for(i=mn(e,r),s=0;s<u;++s)e=n[s],e.x-=i.x,e.y-=i.y;return i.r}function Cn(n){return Math.sqrt(n.value)}function jn(){var n=null,r=1,e=1,t=L;function i(u){const o=gn();return u.x=r/2,u.y=e/2,n?u.eachBefore(I(n)).eachAfter(R(t,.5,o)).eachBefore(J(1)):u.eachBefore(I(Cn)).eachAfter(R(L,1,o)).eachAfter(R(t,u.r/Math.min(r,e),o)).eachBefore(J(Math.min(r,e)/(2*u.r))),u}return i.radius=function(u){return arguments.length?(n=dn(u),i):n},i.size=function(u){return arguments.length?(r=+u[0],e=+u[1],i):[r,e]},i.padding=function(u){return arguments.length?(t=typeof u=="function"?u:pn(+u),i):t},i}function I(n){return function(r){r.children||(r.r=Math.max(0,+n(r)||0))}}function R(n,r,e){return function(t){if(i=t.children){var i,u,o=i.length,f=n(t)*r||0,s;if(f)for(u=0;u<o;++u)i[u].r+=f;if(s=qn(i,e),f)for(u=0;u<o;++u)i[u].r-=f;t.r=s+f}}}function J(n){return function(r){var e=r.parent;r.r*=n,e&&(r.x=e.x+n*r.x,r.y=e.y+n*r.y)}}export{K as h,jn as p};
